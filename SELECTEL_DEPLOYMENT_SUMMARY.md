# üìã –†–µ–∑—é–º–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ Selectel

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –±—ç–∫–µ–Ω–¥–∞ –∏ –ë–î –Ω–∞ –æ–±–ª–∞—á–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ Selectel.

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. **SELECTEL_DEPLOYMENT.md** (–ì–ª–∞–≤–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)
   - üìñ –ü–æ–ª–Ω–æ–µ –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
   - üîß –í—Å–µ —ç—Ç–∞–ø—ã —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
   - üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
   - üîê –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - üìä –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### 2. **QUICK_START_SELECTEL.md** (–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)
   - ‚ö° –ó–∞ 5 –º–∏–Ω—É—Ç
   - ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç
   - üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
   - üÜò –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 3. **backend/docker-compose.prod.yml** (Production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
   - üê≥ Docker Compose –¥–ª—è production
   - ‚ôªÔ∏è –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
   - üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - üè• Health checks

### 4. **backend/.env.production** (–®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è)
   - üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è production
   - üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
   - ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

### 5. **backend/deploy.sh** (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è)
   - üöÄ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —à–∞–≥–æ–≤
   - üìä –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å —Ü–≤–µ—Ç–∞–º–∏
   - üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 6. **backend/assortiShop.service** (Systemd —Å–µ—Ä–≤–∏—Å)
   - üîÑ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
   - üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ systemd journal
   - üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ

## üöÄ –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ)
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ git
git add .
git commit -m "Add Selectel deployment files"
git push
```

### –≠—Ç–∞–ø 2: –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ Selectel

**–®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É**
```bash
ssh root@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/sofar5
git pull  # –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
cd backend
```

**–®–∞–≥ 2: –ò—Å–ø—Ä–∞–≤—å—Ç–µ Docker (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**
```bash
sudo apt remove docker-compose -y
sudo apt update
sudo apt install -y docker-compose-plugin
docker compose version
```

**–®–∞–≥ 3: –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ .env —Ñ–∞–π–ª**
```bash
cp .env.production .env
nano .env  # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

**–®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ**

–í–∞—Ä–∏–∞–Ω—Ç A (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π):
```bash
chmod +x deploy.sh
sudo ./deploy.sh
```

–í–∞—Ä–∏–∞–Ω—Ç B (—Ä—É—á–Ω–æ–π):
```bash
docker compose -f docker-compose.prod.yml up -d
docker compose -f docker-compose.prod.yml exec backend npm run prisma:migrate
```

**–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ**
```bash
curl http://localhost:3000/api/health
docker compose -f docker-compose.prod.yml ps
```

### –≠—Ç–∞–ø 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
sudo cp assortiShop.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable assortiShop.service
sudo systemctl start assortiShop.service
sudo systemctl status assortiShop.service
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
version-five/
‚îú‚îÄ‚îÄ SELECTEL_DEPLOYMENT.md              # –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
‚îú‚îÄ‚îÄ QUICK_START_SELECTEL.md             # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îú‚îÄ‚îÄ SELECTEL_DEPLOYMENT_SUMMARY.md      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îÇ
‚îî‚îÄ‚îÄ backend/
    ‚îú‚îÄ‚îÄ docker-compose.prod.yml         # Production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ .env.production                 # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ deploy.sh                       # –°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ assortiShop.service             # Systemd —Å–µ—Ä–≤–∏—Å
    ‚îÇ
    ‚îú‚îÄ‚îÄ docker/
    ‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile                  # Docker –æ–±—Ä–∞–∑
    ‚îÇ
    ‚îú‚îÄ‚îÄ prisma/
    ‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma               # –°—Ö–µ–º–∞ –ë–î
    ‚îÇ
    ‚îî‚îÄ‚îÄ src/
        ‚îî‚îÄ‚îÄ ...                         # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
```

## üîë –ö–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|---------|-----------|
| `DB_USER` | `assortiuser` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î |
| `DB_PASSWORD` | `CHANGE_ME...` | ‚ö†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å |
| `DB_NAME` | `assortiShop` | –ò–º—è –ë–î |
| `NODE_ENV` | `production` | Production —Ä–µ–∂–∏–º |
| `PORT` | `3000` | –ü–æ—Ä—Ç –±—ç–∫–µ–Ω–¥–∞ |
| `API_URL` | `http://YOUR_IP:3000` | ‚ö†Ô∏è –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à IP/–¥–æ–º–µ–Ω |
| `FRONTEND_URL` | `http://YOUR_IP:5173` | ‚ö†Ô∏è –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à IP/–¥–æ–º–µ–Ω |

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose.prod.yml ps

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats

# –°—Ç–∞—Ç—É—Å systemd —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status assortiShop.service
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
```bash
# –ó–∞–ø—É—Å–∫
docker compose -f docker-compose.prod.yml up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose -f docker-compose.prod.yml down

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
docker compose -f docker-compose.prod.yml restart

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker compose -f docker-compose.prod.yml build --no-cache
docker compose -f docker-compose.prod.yml up -d --build
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –í—Å–µ –ª–æ–≥–∏
docker compose -f docker-compose.prod.yml logs

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose -f docker-compose.prod.yml logs -f

# –¢–æ–ª—å–∫–æ backend
docker compose -f docker-compose.prod.yml logs backend

# –¢–æ–ª—å–∫–æ –ë–î
docker compose -f docker-compose.prod.yml logs postgres

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker compose -f docker-compose.prod.yml logs --tail=100
```

### –†–∞–±–æ—Ç–∞ —Å –ë–î
```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker compose -f docker-compose.prod.yml exec postgres psql -U assortiuser -d assortiShop

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è
docker compose -f docker-compose.prod.yml exec postgres pg_dump -U assortiuser assortiShop > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
docker compose -f docker-compose.prod.yml exec -T postgres psql -U assortiuser assortiShop < backup.sql
```

### Systemd —Å–µ—Ä–≤–∏—Å
```bash
# –°—Ç–∞—Ç—É—Å
sudo systemctl status assortiShop.service

# –ó–∞–ø—É—Å–∫
sudo systemctl start assortiShop.service

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo systemctl stop assortiShop.service

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
sudo systemctl restart assortiShop.service

# –õ–æ–≥–∏
sudo journalctl -u assortiShop.service -f
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: docker compose: command not found
```bash
sudo apt install -y docker-compose-plugin
```

### –ü—Ä–æ–±–ª–µ–º–∞: Permission denied
```bash
sudo usermod -aG docker $USER
newgrp docker
```

### –ü—Ä–æ–±–ª–µ–º–∞: Port 3000 already in use
```bash
sudo lsof -i :3000
sudo kill -9 PID
```

### –ü—Ä–æ–±–ª–µ–º–∞: Database connection refused
```bash
docker compose -f docker-compose.prod.yml logs postgres
docker compose -f docker-compose.prod.yml restart postgres
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å
```bash
docker compose -f docker-compose.prod.yml exec backend npm run prisma:migrate
```

### –ü—Ä–æ–±–ª–µ–º–∞: Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
docker compose -f docker-compose.prod.yml logs backend
docker compose -f docker-compose.prod.yml build --no-cache
docker compose -f docker-compose.prod.yml up -d --build
```

## üîê –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** –¥–ª—è –ë–î
   ```bash
   openssl rand -base64 32
   ```

2. ‚úÖ **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º** —á–µ—Ä–µ–∑ firewall
   ```bash
   sudo ufw allow 22/tcp
   sudo ufw allow 80/tcp
   sudo ufw allow 443/tcp
   sudo ufw enable
   ```

3. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS** –¥–ª—è production (nginx + Let's Encrypt)

4. ‚úÖ **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** Docker –æ–±—Ä–∞–∑—ã
   ```bash
   docker pull postgres:16-alpine
   docker compose -f docker-compose.prod.yml build --no-cache
   ```

5. ‚úÖ **–î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** –ë–î
   ```bash
   docker compose -f docker-compose.prod.yml exec postgres pg_dump -U assortiuser assortiShop > backup_$(date +%Y%m%d).sql
   ```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. üìñ –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `SELECTEL_DEPLOYMENT.md` (–ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)
2. üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose -f docker-compose.prod.yml logs`
3. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Docker –∑–∞–ø—É—â–µ–Ω: `docker ps`
4. üìù –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `cat .env`
5. üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: `docker compose -f docker-compose.prod.yml restart`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Docker –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.docker.com/)
- [Docker Compose –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.docker.com/compose/)
- [PostgreSQL –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://www.postgresql.org/docs/)
- [Prisma –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://www.prisma.io/docs/)
- [Express.js –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://expressjs.com/)

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–í–∞—à –±—ç–∫–µ–Ω–¥ –∏ –ë–î —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –Ω–∞ Selectel –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ! üéâ

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `http://–í–ê–®_IP:3000/api-docs`
- Health check: `http://–í–ê–®_IP:3000/api/health`
- Swagger UI: `http://–í–ê–®_IP:3000/api-docs`

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 18 —Ñ–µ–≤—Ä–∞–ª—è 2026
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
